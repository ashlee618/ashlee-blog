---
title: Nettyï¼šChannelPipelineå’ŒChannelHandlerä¸ºä»€ä¹ˆä¼šé¬¼æ··åœ¨ä¸€èµ·ï¼Ÿ
categories: Netty
tags:
  - IO
  - Netty
cover: >-
  https://hmf-typora-images.oss-cn-guangzhou.aliyuncs.com/images/202307091602399.png
abbrlink: 41945
---



# å‰è¨€

>**æ•°æ®æµ**æ˜¯ç¼–ç¨‹èŒƒå¼ä¸­çš„å…¶ä¸­ä¸€ç§ï¼Œä½•ä¸ºæ•°æ®æµ?

æ•°æ®æµå…·æœ‰**æ— ç©·æ•°æ®æº**ã€**æ•°æ®æµå‘**çš„ç‰¹ç‚¹ï¼š
- æ— ç©·æ•°æ®æºï¼šä½ æ— æ³•é¢„ä¼°ä½ éœ€è¦å¤„ç†çš„æ•°æ®æµï¼Œä½ ä¹Ÿä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ä¼šäº§ç”Ÿæ•°æ®
- æ•°æ®æµå‘ï¼šæ•°æ®ä¼ é€’å…·æœ‰é¡ºåºæ€§

åœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯æƒ³è¦è·ŸæœåŠ¡å™¨è¿›è¡Œæ•°æ®ä¼ é€’ï¼Œé¦–å…ˆå°±è¦é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹`ä¼ è¾“é€šé“`ï¼Œç»‘å®šå¥½ç«¯å£ï¼Œæ­¤åé€šè¿‡è¿™ä¸ªsocketè¿›è¡Œæ•°æ®ä¼ è¾“ã€‚

å½“é€šé“å…³é—­åï¼Œå¦‚æœæƒ³è¦å»ºç«‹è¿æ¥ï¼Œè¿˜éœ€å†æ¬¡ç”±å®¢æˆ·ç«¯å‘èµ·å»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼Œæ‰€ä»¥åé¢æ¼”è¿›äº†ä½¿ç”¨`é•¿è¿æ¥`çš„æ–¹å¼æ¥ä¼˜åŒ–è¿æ¥é¢‘ç¹åœ°å»ºç«‹å’Œé”€æ¯ã€‚

åœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œ`Channel`å°±æ˜¯å¹²è¿™ä¸ªäº‹æƒ…çš„ã€‚


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/72552a9e01c34768925b28364654ae48~tplv-k3u1fbpfcp-watermark.image?)

ç±»ä¼¼äºNIOçš„Channelï¼ŒNettyæä¾›äº†è‡ªå·±çš„`Channel`ï¼Œä½¿å¾—æ›´ç¬¦åˆè‡ªèº«æ¡†æ¶ï¼Œå«åš`ChannelPiple`ã€‚



# Channel
>JDKçš„NIOç±»åº“ç§Channelåˆ†2ç§ï¼š
>-   å®¢æˆ·ç«¯çš„ï¼šSockerChannel
>-   æœåŠ¡ç«¯çš„ï¼šServerSocketChannel


![image-20230314192757251](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1b7c7630df3c4a3fb16569f826a7ba5f~tplv-k3u1fbpfcp-zoom-1.image)

`Unsafe`æ˜¯ä¸€ä¸ªå†…éƒ¨æ¥å£ï¼Œ**èšåˆåœ¨Channelç§ååŠ©è¿›è¡Œç½‘ç»œè¯»å†™ç›¸å…³çš„æ“ä½œ**ã€‚

Unsafeæœ¬èº«æ˜¯ä½œä¸º**Channelçš„ä¸€ä¸ªå†…éƒ¨è¾…åŠ©ç±»**æ¥ç”¨çš„ï¼Œå…¶å®å¹¶ä¸åº”è¯¥è¢«Nettyæ¡†æ¶çš„ä¸Šå±‚ä½¿ç”¨è€…ä½¿ç”¨ï¼Œæ‰€ä»¥æ˜¯è¢«å‘½åä¸ºUnsafe

## Unsafe
> æ˜¯Channelå†…éƒ¨çš„ä¸€ä¸ªå†…éƒ¨å®ç°ç±»ï¼Œæ˜¯ä¸€ä¸ªæ¥å£ç±»å‹

![image-20230313171637248](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/72f7fe911e3149048140d2684319dc83~tplv-k3u1fbpfcp-zoom-1.image)

**ä»–ä¸åº”è¯¥è¢«ç”¨æˆ·ä»£ç ç›´æ¥è°ƒç”¨ï¼Œè€Œæ˜¯ç”±å®é™…è´Ÿè´£IOçš„è¯»å†™çº¿ç¨‹æ¥è°ƒç”¨**ã€‚è¿™ä¹Ÿæ˜¯ä»–çš„åå­—`Unsafe`çš„å«ä¹‰ã€‚

### Unsafeä¸­åŸºç¡€æ–¹æ³•


#### registryæ–¹æ³•

> ä½œç”¨ï¼š**å°†Channelæ³¨å†Œåˆ°EventLoopçš„å¤šè·¯å¤ç”¨å™¨ä¸Š**

ä¸ºäº†**é¿å…å¤šçº¿ç¨‹å¹¶å‘æ“ä½œChanne**lçš„é—®é¢˜ï¼Œè¿™é‡Œè¿˜éœ€è¦åšå¹¶å‘å¤„ç†

åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æ˜¯Channelå¯¹åº”çš„NioEventLoopçº¿ç¨‹

-   å¦‚æœæ˜¯ï¼Œåˆ™ç›´æ¥æ‰§è¡Œè°ƒç”¨`#register0`æ‰§è¡Œæ³¨å†Œé€»è¾‘
-   å¦‚æœä¸æ˜¯ï¼Œåˆ™ä»¥åŒ…æˆ`Runnable`ä¸¢ç»™**NioEventLoop**é‚£è¾¹çº¿ç¨‹æ± çš„ä»»åŠ¡é˜Ÿåˆ—é‡Œå»ç­‰å¾…æ‰§è¡Œ

![image-20230313174814089](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5b7e7e727f614759b8b425e7115ee7a5~tplv-k3u1fbpfcp-zoom-1.image)

#### bindæ–¹æ³•

> **ç»™Channelç»‘å®šå¯¹åº”çš„Socket**
>
> -   å¯¹äºæœåŠ¡ç«¯ï¼Œç”¨äºç»‘å®šç›‘å¬ç«¯å£
> -   å¯¹äºå®¢æˆ·ç«¯ï¼Œç”¨äºæŒ‡å®šå®¢æˆ·ç«¯Channelçš„æœ¬åœ°ç»‘å®šSockeråœ°å€

#### writeæ–¹æ³•

> æŠŠæ¶ˆæ¯æ·»åŠ åˆ°å”¤é†’å‘é€æ•°ç»„ï¼š**ChannelOutboundBuffer**é‡Œé¢ï¼Œå¹¶ä¸æ˜¯çœŸæ­£çš„å†™Channelï¼Œ`flush`æ‰æ˜¯æŠŠæ¶ˆæ¯å†™è¿›Channel

![image-20230313194858950](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f2e5aecee6174e62b9bf30c0bfb156eb~tplv-k3u1fbpfcp-zoom-1.image)


## ChannelPipelineåŠŸèƒ½è¯´æ˜

> io.netty.channel.Channelæ˜¯`Netty`**ç½‘ç»œæ“ä½œæŠ½è±¡ç±»**ï¼Œé‡Œé¢èšåˆäº†JDKçš„Channelå¯¹è±¡

å¯ä»¥Channelç†è§£ä¸ºæ“ä½œç½‘ç»œçš„ä¸€ä¸ªå¯¹è±¡ï¼Œå§”æ´¾è§’è‰²ï¼Œä»–èšåˆäº†ä¸€ç»„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š

-   **ç½‘ç»œçš„è¯»å†™**
-   **å®¢æˆ·ç«¯çš„å‘èµ·è¿æ¥ã€ä¸»åŠ¨å…³é—­è¿æ¥ã€é“¾è·¯å…³é—­**
-   **è·å–åŒæ–¹é€šä¿¡çš„åœ°å€**
-   â€¦

### JDKåŸç”ŸChannel

> JDK ä¹Ÿæœ‰NIOåŸç”Ÿçš„Channelï¼Œä½†æ˜¯Nettyæ˜¯å¦èµ·ç‚‰ç¶è‡ªå·±æŠ½è±¡å‡ºæ¥ä¸€ä¸ªæ–°çš„Channelï¼Œé‚£è¿™é‡Œåˆè¦è®²è®²ï¼Œä¸ºä»€ä¹ˆä¸ç”¨åŸç”ŸJDKçš„ä¸œè¥¿äº†



1.  JDKçš„**SocketChannel**å’Œ**ServerSocketChannel**ä¸»è¦èŒè´£æ˜¯è´Ÿè´£**ç½‘ç»œIO**æ“ä½œã€‚ç”±äºä»–ä»¬æ˜¯`SPI`ç±»æ¥å£ï¼Œæ‰€ä»¥é€šè¿‡ç»§æ‰¿SPIåŠŸèƒ½ç±»æ¥æ‰©å±•å…¶åŠŸèƒ½éš¾åº¦å¤§

    ***SPIå’ŒAPIçš„åŒºåˆ«ï¼è¿˜ä¸æ‡‚çš„èµ¶ç´§å»å¤ä¹ ï¼Œé¢è¯•å¸¸è€ƒå†…å®¹ï¼***
    
![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5d80ae83866c4def9048d6b0ddb9a39f~tplv-k3u1fbpfcp-watermark.image?)

2.  Nettyçš„Channelèƒ½å¤Ÿè·ŸNettyçš„æ•´ä½“æ¶æ„èåˆåœ¨ä¸€èµ·ï¼Œ**è·Ÿæ¶æ„äº²å’ŒåŠ›æ›´è¶³**ã€‚

3.  **è‡ªå®šä¹‰Channel**ï¼ŒåŠŸèƒ½å®ç°æ›´åŠ çµæ´»ï¼ˆæ„Ÿè§‰è¿™ä¸ªæ‰æ˜¯æœ€é‡è¦çš„ï¼‰

> Nettyçš„Channelè®¾è®¡ç†å¿µ

1.  åœ¨`Channel`æ¥å£å±‚ï¼Œé‡‡ç”¨`Facade`ï¼ˆå¤–è§‚æ¨¡å¼ï¼‰è¿›è¡Œç»Ÿä¸€å°è£…ï¼Œ**ç›¸å½“äºä¸€ä¸ªèšåˆäº†ä¸€ä¸ªJDKåŸç”ŸChannelçš„ä¸€ä¸ªæ“ä½œå¯¹è±¡**
2.  ä¸ºSocketChannelã€ServerSocketChannelæä¾›**ç»Ÿä¸€çš„è§†å›¾**ï¼Œå…¬å…±åŠŸèƒ½åœ¨çˆ¶ç±»ä¸­å®ç°ï¼Œå­ç±»å®ç°æ›´ä¸ºå…·ä½“çš„åŠŸèƒ½
3.  å…·ä½“å®ç°**é‡‡ç”¨èšåˆè€ŒéåŒ…å«çš„æ–¹å¼**ï¼Œå°†ç›¸å…³çš„åŠŸèƒ½èšåˆåœ¨Channelç§ï¼Œç”±Channel**ç»Ÿä¸€è´Ÿè´£åˆ†é…å’Œè°ƒåº¦**ã€‚


### ç½‘ç»œè¯»å†™æ“ä½œ

> ç½‘ç»œIOæ“ä½œä¼šè§¦å‘`ChannelPipeline`ä¸­å¯¹åº”çš„äº‹ä»¶æ–¹æ³•

Neetyæ˜¯åŸºäº**äº‹ä»¶é©±åŠ¨**ï¼Œå½“`Channel`è¿›è¡ŒIOæ“ä½œæ—¶ï¼Œä¼šäº§ç”Ÿå¯¹åº”çš„IOäº‹ä»¶ï¼Œç„¶å**é©±åŠ¨äº‹ä»¶åœ¨ChannelPipelineä¸­ä¼ æ’­**ï¼Œæœ€å**ç”±ChannelHandlerå¯¹äº‹ä»¶è¿›è¡Œæ‹¦æˆªå’Œå¤„ç†**ï¼Œä¸å…³å¿ƒçš„äº‹ä»¶å¯ä»¥ç›´æ¥å¿½ç•¥ã€‚

é‡‡ç”¨**äº‹ä»¶é©±åŠ¨**çš„æ–¹å¼ï¼Œæœ‰å¾ˆå¤šä¼˜ç‚¹ï¼š

-   é¦–å…ˆå¯ä»¥é¿å…ç›‘å¬è€…åˆ—è¡¨è¿‡é•¿ï¼Œè§¦å‘ä¸€æ¬¡äº‹ä»¶ï¼Œé‡‡ç”¨**é¡ºåºéå†**æ€§èƒ½ä¼šçº¿æ€§ä¸‹é™
-   é‡‡ç”¨äº‹ä»¶é©±åŠ¨å¯ä»¥å¾ˆè½»æ¾**é€šè¿‡äº‹ä»¶æ¥åˆ’åˆ†äº‹ä»¶æ‹¦æˆªåˆ‡é¢**ï¼Œæ•ˆæœç­‰ä»·äº`AOP`ï¼Œç”šè‡³æ¯”ä»–æ€§èƒ½æ›´é«˜

**ç½‘ç»œIOæ“ä½œ**ç›´æ¥è°ƒç”¨`DefaultChannelPipeline`çš„ç›¸å…³æ–¹æ³•ï¼Œç”±å‰è€…ä¸­å¯¹åº”çš„`ChannelHandler`æ¥è¿›è¡Œé€»è¾‘å¤„ç†ã€‚

### AbstractChannelç½‘ç»œIOæ“ä½œæºç å®ç°
æˆå‘˜å˜é‡ï¼š
-   `SelectableChannel`ï¼šç”¨äºè®¾ç½®å‚æ•°å’Œè¿›è¡ŒIOæ“ä½œ
-   `readInterestOp`ï¼šä»£è¡¨äº†**JDK SelectionKey**çš„**OP_READ**
-   `SelectionKey`ï¼šç”¨**volatile**ä¿®é¥°ï¼Œç”±äºChannelä¼šé¢ä¸´**å¤šä¸ªä¸šåŠ¡çº¿ç¨‹å¹¶å‘å†™æ“ä½œ**ï¼Œæ‰€ä»¥ä¸ºäº†èƒ½è®©å…¶ä»–çº¿ç¨‹å¯¹å…¶æ„ŸçŸ¥å˜åŒ–ï¼Œæ‰€ä»¥ä½¿ç”¨volatileä¿è¯å¯è§æ€§

#### Channelçš„æ³¨å†Œ
> doRegisterï¼ŒæŠŠChannelæ³¨å†Œåˆ°EventLoopä¸­

![image-20230311150250967](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ba3ec0c7611d435c82c99a3abb52fdb4~tplv-k3u1fbpfcp-zoom-1.image)

å¯ä»¥çœ‹åˆ°ç¬¬äºŒä¸ªå‚æ•°`ops`ï¼Œä»£è¡¨æ„Ÿå…´è¶£çš„äº‹ä»¶ï¼ŒdoRegistryçš„æ—¶å€™ç›´æ¥ä¼ äº†ä¸ª0ï¼Œä»£è¡¨å¯¹ä»»ä½•äº‹ä»¶éƒ½ä¸æ„Ÿå…´è¶£

![image-20230311150311969](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2bd7bb3068f74f678ea312527f9ea14b~tplv-k3u1fbpfcp-zoom-1.image)

Channelå¯¹å“ªäº›äº‹ä»¶æ„Ÿå…´è¶£å‘¢ï¼Œæ¯”å¦‚ï¼š

-   `OP_READ` = 1 << 0ï¼› è¯»æ“ä½œä½
-   `OP_WRITE` = 1 << 2ï¼›å†™æ“ä½œä½
-   `OP_CONNECT` = 1 << 3ï¼›å®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯ï¼Œå»ºç«‹è¿æ¥æ“ä½œ
-   `OP_ACCEPT` = 1 << 4ï¼›æœåŠ¡ç«¯æ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼ŒæˆåŠŸå»ºç«‹è¿æ¥æ“ä½œ

ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æŠŠè‡ªå·±`this`ä¼ è¿‡å»äº†ï¼Œè¿™æ˜¯ä¸ºäº†èƒ½è®©è§¦å‘äº‹ä»¶çš„æ—¶å€™è¿”å›`SelectionKey`ã€‚

**æ ¹æ®SelectionKeyæ˜¯å¯ä»¥åœ¨å¤šè·¯å¤ç”¨å™¨æ‹¿åˆ°å¯¹åº”æ„Ÿå…´è¶£çš„Channelå¯¹è±¡**ï¼Œç„¶åå»è¿›è¡Œå¤„ç†ã€‚


# ChannelPipeline

## ChannelPipelineå’ŒChannelHandler

> `ChannelPipleine`å’Œ`ChannelHandler`æœºåˆ¶ç±»ä¼¼äº**Servlet**å’Œ**Filter**è¿‡æ»¤å™¨

æœ¬è´¨ä¸Šæ˜¯**è´£ä»»é“¾æ¨¡å¼**çš„å®ç°ã€‚

**Servlet Filter**èƒ½å¤Ÿä»¥**å£°æ˜å¼**çš„æ–¹æ³•æ’å…¥åˆ°HTTPè¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­ã€‚ç”¨äº**æ‹¦æˆªè¯·æ±‚å’Œå“åº”**ï¼Œå®ç°å¯¹è¯·æ±‚çš„**å‰ç½®å¤„ç†**å’Œ**åç½®å¤„ç†**ã€‚

Nettyçš„Channelè¿‡æ»¤å™¨å®ç°åŸç†è·ŸServlet Filteræœºåˆ¶ä¸€è‡´ï¼Œå®ƒå°†Channelçš„æ•°æ®ç®¡é“æŠ½è±¡æˆï¼š`ChannelPipeline`ã€‚

![image-20230314192757251](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b1b7e5dd2e6c49109b459b1b4ca6a4ed~tplv-k3u1fbpfcp-zoom-1.image)

æ•°æ®åœ¨`ChannelPipeline`ä¸­æµåŠ¨å’Œä¼ é€’ï¼Œ`ChannelPipeline`ä¸­æŒæœ‰IOäº‹ä»¶æ‹¦æˆªå™¨`ChannelHandler`çš„**é“¾è¡¨**ã€‚

æ„å‘³ç€ï¼š**`ChannelHandler`å¯ä»¥å¯¹IOäº‹ä»¶è¿›è¡Œæ‹¦æˆªå’Œå¤„ç†**

`ChannelHandler`æ˜¯**å¯æ’æ‹”å¼**çš„ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡**æ–°å¢æˆ–è€…åˆ é™¤**`ChannelHandler`æ¥å®ç°ä¸åŒä¸šåŠ¡é€»è¾‘ï¼Œ

## ChannelPipelineåŠŸèƒ½è¯´æ˜
> ChannelPipelineæ˜¯ChannelHandlerçš„å®¹å™¨
> 
> è´Ÿè´£ChannelHandlerçš„ç®¡ç†å’Œ**äº‹ä»¶æ‹¦æˆªä¸è°ƒåº¦**

ä¸»è¦æ˜¯ï¼š**è´Ÿè´£äº‹ä»¶çš„åˆ†å‘å’Œé¢„å¤„ç†**

ä¸€ä¸ªæ¶ˆæ¯è¢«ChannelPipelineçš„ChannelHandleré“¾æ‹¦æˆªå’Œå¤„ç†çš„å…¨è¿‡ç¨‹ï¼š

![image-20230314095713102](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0a63890e8e054403b7423865be663d9d~tplv-k3u1fbpfcp-zoom-1.image)

1.  åº•å±‚çš„SocketChannel `#read`æ–¹æ³•è¯»å–ByteBufï¼Œè§¦å‘ChannelReadäº‹ä»¶ï¼ˆ`OP_READ`ï¼‰ï¼Œç”±IOçº¿ç¨‹`NioEventLoop`è°ƒç”¨ChannelPipelineçš„`#fireChannelRead`æ–¹æ³•ï¼Œå°†æ¶ˆæ¯ï¼ˆByteBufï¼‰ä¼ è¾“åˆ°**ChannelPipeline**ä¸­

2.  æ¶ˆæ¯ä¾æ¬¡è¢«æ·»åŠ å¥½çš„ChannelHandleré“¾å¤„ç†ï¼Œé¦–å…ˆæ˜¯HeadHandlerï¼Œç„¶åæ˜¯ChannelHandler1ã€ChannelHandler2â€¦.ï¼Œ**ä»»ä½•Handleréƒ½å¯ä»¥ä¸­æ–­æ¶ˆæ¯çš„ä¼ é€’ï¼Œä¹Ÿå°±æ˜¯ä»–ä»¬éƒ½å¯ä»¥æŠŠæ¶ˆæ¯ä¸¢æ‰**ã€‚

    æ³¨æ„ï¼šè¿™é‡Œæ˜¯å…ˆæ˜¯è¢«`HeadHandler`å¤„ç†ï¼Œåé¢æ˜¯åè¿‡æ¥ï¼Œ**æ˜¯æœ‰é¡ºåºçš„**

3.  ChannelHandlerContextçš„`#write`æ–¹æ³•å‘é€æ¶ˆæ¯ï¼Œæ¶ˆæ¯ä»`TailHandler`å¼€å§‹ï¼Œé€”å¾„ChannelHandlerNï¼ŒChannelHandlerN-1â€¦.

    æœ€ç»ˆè¢«æ·»åŠ åˆ°**æ¶ˆæ¯å‘é€ç¼“å†²åŒºä¸­**ï¼Œç­‰å¾…åˆ·æ–°ï¼ˆ`flush`ï¼‰å’Œå‘é€ï¼ˆ`write`ï¼‰

> æ³¨æ„ï¼š**è¿™é‡Œä¸ºä»€ä¹ˆæ˜¯å…·æœ‰é¡ºåºæ€§åœ°å¤„ç†**ï¼Œå› ä¸ºæœ‰äº›ChanelHandlerå°±æœ‰**é¡ºåºæ€§**ï¼Œæ¯”å¦‚è§£ç é‚£äº›ï¼Œéœ€è¦å…ˆå°†ByteBufæ•°æ®è§£ææˆå¯¹è±¡ï¼Œç„¶åå†å°†å¯¹è±¡äºŒæ¬¡è§£ç æˆpojoå¯¹è±¡ã€‚

Nettyä¸­çš„äº‹ä»¶åˆ†ä¸ºï¼š`inbound`äº‹ä»¶å’Œ`outbound`äº‹ä»¶ï¼Œ**å›¾ä¸­å·¦åŠè¾¹å¯¹åº”inboudäº‹ä»¶ï¼Œå³åŠè¾¹å¯¹åº”outboundäº‹ä»¶**ã€‚

-   `inbound`ï¼šç”±å¤–éƒ¨è§¦å‘çš„äº‹ä»¶ï¼Œåº”ç”¨ç¨‹åºä»¥å¤–çš„ï¼Œå¹¶éåº”ç”¨ç¨‹åºè‡ªå·±è¯·æ±‚çš„ã€‚æ¯”å¦‚æŸä¸ªsocketæœ‰æ•°æ®è¯»å–è¿›æ¥äº†ï¼Œæœ‰Channelæ³¨å†Œåˆ°Eventloopä¸Šäº†
-   `outbound`ï¼šç”±åº”ç”¨ç¨‹åºä¸»åŠ¨è¯·æ±‚è€Œè§¦å‘çš„äº‹ä»¶ï¼Œæ¯”å¦‚å‘æŸä¸ªsocketå†™å…¥æ•°æ®ï¼Œæˆ–ä»æŸä¸ªsocketè¯»å–æ•°æ®

**ChannelInboundHandler**å¤„ç†`inboud`äº‹ä»¶

**ChannelOutboundHandler**å¤„ç†`outbound`äº‹ä»¶

> è¯¯åŒºï¼šåŒºåˆ†inboudã€outboundå¹¶ä¸æ˜¯ç®€å•çš„IOæµï¼Œè€Œæ˜¯**è§¦å‘äº‹ä»¶çš„æºå¤´**

# æ€»ç»“

æœ¬ç¯‡ç®€å•ä»‹ç»äº†JDKè‡ªå¸¦çš„`Channel`ä»¥åŠ`Unsafe`å…¶å†…éƒ¨çš„ä¸€ä¸ªå®ç°ç±»ã€‚å¹¶ä¸”ä»`Unsafe`çš„èŒè´£æ¥æ›´å¥½çš„ç†è§£å®ƒè¿™ä¸ªåå­—çš„å«ä¹‰ã€‚

Nettyæä¾›çš„`ChannelPipeline`å†…éƒ¨èšåˆäº†ä¸€ä¸ª`ChannelHandler`é“¾è¡¨ã€‚`ChannelPipeline`è´Ÿè´£ç½‘ç»œIOäº‹ä»¶ä¸­çš„è°ƒåº¦ï¼Œè€Œ`ChannelHandler`åˆ™æ˜¯è´Ÿè´£æ‹¦æˆªï¼Œå¦‚æœæ˜¯å¯¹åº”æ„Ÿå…´è¶£çš„äº‹ä»¶åˆ™å¤„ç†ï¼Œå¦åˆ™æŠ›ç»™ä¸‹ä¸€ä¸ª`ChannleHandler`ã€‚

ç²—ç•¥åœ°è®²äº†ä¸€ä¸‹ChannelHandlerä¸ºä»€ä¹ˆè¦åŸºäº**è´£ä»»é“¾**çš„è®¾è®¡æ¨¡å¼ï¼Œåšæˆé“¾è¡¨çš„å½¢å¼ã€‚ä¸‹ä¸€ç¯‡æ–‡ç« ä¼šç€é‡è®²ä¸€ä¸‹ChannelHandleråœ¨Nettyé‡Œé¢å¹²äº†äº›ä»€ä¹ˆäº‹æƒ…ã€‚


![_ZW$55A8PHP)%8HW6RVRV2E.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a33dad9d24be48478cd52e4f15dae0ee~tplv-k3u1fbpfcp-watermark.image?)

> æ¥éƒ½æ¥äº†ï¼Œç‚¹ä¸ªèµå†èµ°å§å½¦ç¥–ğŸ‘ï¼Œè¿™å¯¹æˆ‘æ¥è¯´éå¸¸é‡è¦ï¼
